{"topicSections":[{"identifiers":["doc:\/\/com.karwa.WebURL\/documentation\/UnicodeDataStructures\/CodePointDatabase\/BMPIndex"],"title":"Structures"},{"identifiers":["doc:\/\/com.karwa.WebURL\/documentation\/UnicodeDataStructures\/CodePointDatabase\/init(asciiData:bmpIndex:bmpData:nonbmpData:)"],"title":"Initializers"},{"identifiers":["doc:\/\/com.karwa.WebURL\/documentation\/UnicodeDataStructures\/CodePointDatabase\/subscript(_:)"],"title":"Subscripts"},{"identifiers":["doc:\/\/com.karwa.WebURL\/documentation\/UnicodeDataStructures\/CodePointDatabase\/SplitTable"],"title":"Type Aliases"},{"identifiers":["doc:\/\/com.karwa.WebURL\/documentation\/UnicodeDataStructures\/CodePointDatabase\/LookupResult"],"title":"Enumerations"}],"variants":[{"paths":["\/documentation\/unicodedatastructures\/codepointdatabase"],"traits":[{"interfaceLanguage":"swift"}]}],"abstract":[{"type":"text","text":"An immutable database of information about Unicode code-points."}],"schemaVersion":{"patch":0,"major":0,"minor":3},"hierarchy":{"paths":[["doc:\/\/com.karwa.WebURL\/documentation\/UnicodeDataStructures"]]},"identifier":{"url":"doc:\/\/com.karwa.WebURL\/documentation\/UnicodeDataStructures\/CodePointDatabase","interfaceLanguage":"swift"},"primaryContentSections":[{"kind":"declarations","declarations":[{"platforms":["Linux"],"languages":["swift"],"tokens":[{"kind":"keyword","text":"struct"},{"kind":"text","text":" "},{"kind":"identifier","text":"CodePointDatabase"},{"kind":"text","text":"<"},{"kind":"genericParameter","text":"Schema"},{"kind":"text","text":"> "},{"kind":"keyword","text":"where"},{"kind":"text","text":" "},{"kind":"typeIdentifier","text":"Schema"},{"kind":"text","text":" : "},{"kind":"typeIdentifier","identifier":"doc:\/\/com.karwa.WebURL\/documentation\/UnicodeDataStructures\/CodePointDatabase_Schema","text":"CodePointDatabase_Schema","preciseIdentifier":"s:21UnicodeDataStructures24CodePointDatabase_SchemaP"}]}]},{"kind":"content","content":[{"text":"Overview","type":"heading","level":2,"anchor":"overview"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Databases can be constructed using a "},{"type":"codeVoice","code":"CodePointDatabase.Builder"},{"type":"text","text":", after which they may be queried,"},{"type":"text","text":" "},{"type":"text","text":"or printed as a Swift source file."}]},{"type":"paragraph","inlineContent":[{"text":"Data is stored in 3 sections:","type":"text"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"A direct lookup for ASCII code-points, to values of the ","type":"text"},{"code":"Schema.ASCIIData","type":"codeVoice"},{"text":" type.","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"A 2-stage, indexed lookup for BMP code-points, to values of the ","type":"text"},{"code":"Schema.UnicodeData","type":"codeVoice"},{"text":" type.","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"The top N bits of the code-point are indexed, where N is chosen by the Schema."},{"type":"text","text":" "},{"type":"text","text":"This means a O(1), branchless reduction in the search space to a block of entries covering 2^(16 - N) code-points."},{"type":"text","text":" "},{"type":"text","text":"For a list of "},{"type":"codeVoice","code":"n"},{"type":"text","text":" elements, a binary-search requires a maximum of "},{"type":"codeVoice","code":"log2(n)"},{"type":"text","text":" comparisons,"},{"type":"text","text":" "},{"type":"text","text":"meaning that in the worst case, when every code-point has an individual data entry, we would need a maximum"},{"type":"text","text":" "},{"type":"text","text":"of (16 - N) comparisons to locate the data for an arbitrary code-point."}]},{"type":"paragraph","inlineContent":[{"text":"Often it will be much fewer than that, because the data entries are grouped in to regions.","type":"text"},{"text":" ","type":"text"},{"text":"For example, the IDNA mapping table has about 4000 entries for all 2^16 code-points in the BMP.","type":"text"},{"text":" ","type":"text"},{"text":"Code-point and data tables are split to avoid padding and improve cache performance.","type":"text"}]}]},{"content":[{"inlineContent":[{"text":"Per-plane binary-searched tables for non-BMP code-points, to values of the ","type":"text"},{"code":"Schema.UnicodeData","type":"codeVoice"},{"text":" type.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"Most planes outside the BMP are "},{"type":"reference","identifier":"https:\/\/en.wikipedia.org\/wiki\/Plane_(Unicode)","isActive":true},{"type":"text","text":", but"},{"type":"text","text":" "},{"type":"text","text":"the ones that are include plane 1, the SMP (mostly historic scripts and emoji), and planes 2 and 3 -"},{"type":"text","text":" "},{"type":"text","text":"the SIP and TIP respectively, containing CJK ideographs."}],"type":"paragraph"},{"inlineContent":[{"text":"Per-plane tables means we can represent code-points as 16-bit values, which more efficiently","type":"text"},{"text":" ","type":"text"},{"text":"packs their contents and improves cache utilization. Code-point and data tables are split","type":"text"},{"text":" ","type":"text"},{"text":"to avoid padding and also improve cache performance.","type":"text"}],"type":"paragraph"}]}]}]}],"kind":"symbol","metadata":{"navigatorTitle":[{"text":"CodePointDatabase","kind":"identifier"}],"externalID":"s:21UnicodeDataStructures17CodePointDatabaseV","fragments":[{"text":"struct","kind":"keyword"},{"text":" ","kind":"text"},{"text":"CodePointDatabase","kind":"identifier"}],"modules":[{"name":"UnicodeDataStructures"}],"role":"symbol","symbolKind":"struct","roleHeading":"Structure","title":"CodePointDatabase"},"sections":[],"references":{"doc://com.karwa.WebURL/documentation/UnicodeDataStructures/CodePointDatabase":{"type":"topic","role":"symbol","abstract":[{"text":"An immutable database of information about Unicode code-points.","type":"text"}],"identifier":"doc:\/\/com.karwa.WebURL\/documentation\/UnicodeDataStructures\/CodePointDatabase","fragments":[{"text":"struct","kind":"keyword"},{"text":" ","kind":"text"},{"text":"CodePointDatabase","kind":"identifier"}],"kind":"symbol","url":"\/documentation\/unicodedatastructures\/codepointdatabase","title":"CodePointDatabase","navigatorTitle":[{"text":"CodePointDatabase","kind":"identifier"}]},"doc://com.karwa.WebURL/documentation/UnicodeDataStructures/CodePointDatabase/subscript(_:)":{"type":"topic","url":"\/documentation\/unicodedatastructures\/codepointdatabase\/subscript(_:)","identifier":"doc:\/\/com.karwa.WebURL\/documentation\/UnicodeDataStructures\/CodePointDatabase\/subscript(_:)","role":"symbol","abstract":[],"kind":"symbol","fragments":[{"text":"subscript","kind":"keyword"},{"text":"(","kind":"text"},{"text":"Unicode","kind":"typeIdentifier","preciseIdentifier":"s:s7UnicodeO"},{"text":".","kind":"text"},{"kind":"typeIdentifier","text":"Scalar","preciseIdentifier":"s:s7UnicodeO6ScalarV"},{"kind":"text","text":") -> "},{"kind":"typeIdentifier","text":"CodePointDatabase","preciseIdentifier":"s:21UnicodeDataStructures17CodePointDatabaseV"},{"kind":"text","text":"<"},{"kind":"typeIdentifier","text":"Schema"},{"kind":"text","text":">."},{"kind":"typeIdentifier","text":"LookupResult","preciseIdentifier":"s:21UnicodeDataStructures17CodePointDatabaseV12LookupResultO"}],"title":"subscript(_:)","conformance":{"availabilityPrefix":[{"text":"Available when","type":"text"}],"conformancePrefix":[{"text":"Conforms when","type":"text"}],"constraints":[{"type":"codeVoice","code":"Schema"},{"text":" conforms to ","type":"text"},{"type":"codeVoice","code":"CodePointDatabase_Schema"},{"text":".","type":"text"}]}},"doc://com.karwa.WebURL/documentation/UnicodeDataStructures/CodePointDatabase/SplitTable":{"type":"topic","role":"symbol","abstract":[],"identifier":"doc:\/\/com.karwa.WebURL\/documentation\/UnicodeDataStructures\/CodePointDatabase\/SplitTable","fragments":[{"text":"typealias","kind":"keyword"},{"text":" ","kind":"text"},{"text":"SplitTable","kind":"identifier"}],"kind":"symbol","url":"\/documentation\/unicodedatastructures\/codepointdatabase\/splittable","title":"CodePointDatabase.SplitTable","navigatorTitle":[{"text":"SplitTable","kind":"identifier"}]},"doc://com.karwa.WebURL/documentation/UnicodeDataStructures/CodePointDatabase/LookupResult":{"role":"symbol","identifier":"doc:\/\/com.karwa.WebURL\/documentation\/UnicodeDataStructures\/CodePointDatabase\/LookupResult","title":"CodePointDatabase.LookupResult","url":"\/documentation\/unicodedatastructures\/codepointdatabase\/lookupresult","type":"topic","navigatorTitle":[{"kind":"identifier","text":"LookupResult"}],"kind":"symbol","fragments":[{"kind":"keyword","text":"enum"},{"kind":"text","text":" "},{"kind":"identifier","text":"LookupResult"}],"conformance":{"conformancePrefix":[{"type":"text","text":"Conforms when"}],"availabilityPrefix":[{"text":"Available when","type":"text"}],"constraints":[{"type":"codeVoice","code":"Schema"},{"type":"text","text":" conforms to "},{"type":"codeVoice","code":"CodePointDatabase_Schema"},{"type":"text","text":"."}]},"abstract":[]},"https://en.wikipedia.org/wiki/Plane_(Unicode)":{"url":"https:\/\/en.wikipedia.org\/wiki\/Plane_(Unicode)","type":"link","identifier":"https:\/\/en.wikipedia.org\/wiki\/Plane_(Unicode)","title":"not assigned","titleInlineContent":[{"type":"text","text":"not assigned"}]},"doc://com.karwa.WebURL/documentation/UnicodeDataStructures/CodePointDatabase/init(asciiData:bmpIndex:bmpData:nonbmpData:)":{"title":"init(asciiData:bmpIndex:bmpData:nonbmpData:)","abstract":[{"text":"Initializes a database from static data.","type":"text"}],"identifier":"doc:\/\/com.karwa.WebURL\/documentation\/UnicodeDataStructures\/CodePointDatabase\/init(asciiData:bmpIndex:bmpData:nonbmpData:)","kind":"symbol","fragments":[{"text":"init","kind":"identifier"},{"text":"(","kind":"text"},{"text":"asciiData","kind":"externalParam"},{"text":": [","kind":"text"},{"text":"Schema","kind":"typeIdentifier"},{"text":".","kind":"text"},{"text":"ASCIIData","kind":"typeIdentifier"},{"text":".","kind":"text"},{"text":"RawStorage","kind":"typeIdentifier"},{"text":"], ","kind":"text"},{"text":"bmpIndex","kind":"externalParam"},{"text":": [","kind":"text"},{"text":"CodePointDatabase","kind":"typeIdentifier","preciseIdentifier":"s:21UnicodeDataStructures17CodePointDatabaseV"},{"text":"<","kind":"text"},{"text":"Schema","kind":"typeIdentifier"},{"text":">.","kind":"text"},{"text":"BMPIndex","kind":"typeIdentifier","preciseIdentifier":"s:21UnicodeDataStructures17CodePointDatabaseV8BMPIndexV"},{"text":".","kind":"text"},{"text":"IndexStorage","kind":"typeIdentifier","preciseIdentifier":"s:21UnicodeDataStructures17CodePointDatabaseV8BMPIndexV12IndexStoragea"},{"text":"], ","kind":"text"},{"text":"bmpData","kind":"externalParam"},{"text":": ","kind":"text"},{"text":"CodePointDatabase","kind":"typeIdentifier","preciseIdentifier":"s:21UnicodeDataStructures17CodePointDatabaseV"},{"text":"<","kind":"text"},{"text":"Schema","kind":"typeIdentifier"},{"text":">.","kind":"text"},{"text":"SplitTable","kind":"typeIdentifier","preciseIdentifier":"s:21UnicodeDataStructures17CodePointDatabaseV10SplitTablea"},{"text":"<","kind":"text"},{"text":"UInt16","kind":"typeIdentifier","preciseIdentifier":"s:s6UInt16V"},{"text":", ","kind":"text"},{"text":"Schema","kind":"typeIdentifier"},{"text":".","kind":"text"},{"text":"UnicodeData","kind":"typeIdentifier"},{"text":".","kind":"text"},{"text":"RawStorage","kind":"typeIdentifier"},{"text":">, ","kind":"text"},{"text":"nonbmpData","kind":"externalParam"},{"text":": [","kind":"text"},{"text":"CodePointDatabase","kind":"typeIdentifier","preciseIdentifier":"s:21UnicodeDataStructures17CodePointDatabaseV"},{"text":"<","kind":"text"},{"text":"Schema","kind":"typeIdentifier"},{"text":">.","kind":"text"},{"text":"SplitTable","kind":"typeIdentifier","preciseIdentifier":"s:21UnicodeDataStructures17CodePointDatabaseV10SplitTablea"},{"text":"<","kind":"text"},{"text":"UInt16","kind":"typeIdentifier","preciseIdentifier":"s:s6UInt16V"},{"text":", ","kind":"text"},{"text":"Schema","kind":"typeIdentifier"},{"text":".","kind":"text"},{"text":"UnicodeData","kind":"typeIdentifier"},{"text":".","kind":"text"},{"text":"RawStorage","kind":"typeIdentifier"},{"text":">])","kind":"text"}],"type":"topic","url":"\/documentation\/unicodedatastructures\/codepointdatabase\/init(asciidata:bmpindex:bmpdata:nonbmpdata:)","role":"symbol"},"doc://com.karwa.WebURL/documentation/UnicodeDataStructures/CodePointDatabase_Schema":{"navigatorTitle":[{"kind":"identifier","text":"CodePointDatabase_Schema"}],"fragments":[{"text":"protocol","kind":"keyword"},{"kind":"text","text":" "},{"kind":"identifier","text":"CodePointDatabase_Schema"}],"title":"CodePointDatabase_Schema","kind":"symbol","identifier":"doc:\/\/com.karwa.WebURL\/documentation\/UnicodeDataStructures\/CodePointDatabase_Schema","role":"symbol","url":"\/documentation\/unicodedatastructures\/codepointdatabase_schema","type":"topic","abstract":[{"type":"text","text":"Describes the data associated with code-points in a "},{"type":"codeVoice","code":"CodePointDatabase"},{"type":"text","text":"."}]},"doc://com.karwa.WebURL/documentation/UnicodeDataStructures":{"role":"collection","identifier":"doc:\/\/com.karwa.WebURL\/documentation\/UnicodeDataStructures","title":"UnicodeDataStructures","url":"\/documentation\/unicodedatastructures","type":"topic","kind":"symbol","abstract":[]},"doc://com.karwa.WebURL/documentation/UnicodeDataStructures/CodePointDatabase/BMPIndex":{"kind":"symbol","role":"symbol","fragments":[{"text":"struct","kind":"keyword"},{"text":" ","kind":"text"},{"text":"BMPIndex","kind":"identifier"}],"abstract":[],"type":"topic","url":"\/documentation\/unicodedatastructures\/codepointdatabase\/bmpindex","navigatorTitle":[{"text":"BMPIndex","kind":"identifier"}],"identifier":"doc:\/\/com.karwa.WebURL\/documentation\/UnicodeDataStructures\/CodePointDatabase\/BMPIndex","title":"CodePointDatabase.BMPIndex"}}}